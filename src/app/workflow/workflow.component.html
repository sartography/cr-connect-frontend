<mat-sidenav-container>
  <mat-sidenav mode="side" opened  [fixedInViewport]="true" [fixedTopGap]="64">
    <button mat-button routerLink="/study/{{studyId}}" [ngClass]="'back'">
      <mat-icon>chevron_left</mat-icon>
      Back
    </button>

    <h3>Available Tasks:</h3>
    <em>The following tasks need your attention:</em>
    <app-workflow-steps-menu-list *ngFor="let task of allTasks"
      [task]="task"
      [isCurrent] = "task.id === currentTask.id"
      (taskSelected)="setCurrentTask($event)"
    ></app-workflow-steps-menu-list>
    <h3>Workflow Files:</h3>
    <app-workflow-files *ngIf="workflow" [workflow]="workflow"></app-workflow-files>
  </mat-sidenav>
  <mat-sidenav-content>
    <app-workflow-form *ngIf="hasIncompleteUserTask(); else noTask"
      [task]="currentTask"
      [workflow]="workflow"
      (workflowUpdated)="workflowUpdated($event)"
    ></app-workflow-form>
  </mat-sidenav-content>
</mat-sidenav-container>

<ng-template #noTask>
  <div class="task-status" fxLayout="column" fxLayoutAlign="center center">
    <div class="non-user-task" *ngIf="currentTask">
      <div class="documentation" *ngIf="currentTask.documentation">
        <markdown [data]="currentTask.documentation"></markdown>
      </div>
      <div *ngIf="!currentTask.documentation">
        <h1>{{currentTask.name}}</h1>
        <h2>Task type: {{currentTask.type}}</h2>
        <h3>Status: {{currentTask.state}}</h3>
        <p>Please add documentation to this event to provide users with a custom message
        about their progress.</p>
        <code>
          {{currentTask.data | json}}
        </code>
      </div>
    </div>
    <div class="no-task" *ngIf="!currentTask">
      <h1>No tasks found.</h1>
      <p>This workflow does not have any tasks in it.</p>
    </div>
  </div>
</ng-template>
